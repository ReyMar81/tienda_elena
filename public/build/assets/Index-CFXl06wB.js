import{r as C,h as L,g as T,w as u,b as s,a as b,c as n,f,e as d,o as i,t as o,d as R,j,p as q,q as W,u as g,i as v,F,m as O,n as x,N as H}from"./app-9HEqLJnm.js";import{_ as J}from"./AppLayout-DD1QV7aw.js";import{_ as K}from"./PagoModal-CakDScIU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DialogModal-DAvYmej3.js";import"./Modal-CRs6EPgD.js";import"./PrimaryButton-CtN6bpro.js";import"./SecondaryButton-D5Y2-mVN.js";const Q={class:"container py-4"},X={key:0,class:"alert alert-success alert-dismissible fade show mb-4",role:"alert"},Y={key:1,class:"alert alert-danger alert-dismissible fade show mb-4",role:"alert"},Z={class:"row mb-4"},ss={class:"col-md-3"},ts={class:"card border-0 shadow-sm bg-primary text-white"},es={class:"card-body"},as={class:"d-flex align-items-center"},os={class:"flex-grow-1 ms-3"},ls={class:"mb-0"},is={class:"col-md-3"},ns={class:"card border-0 shadow-sm bg-warning text-dark"},ds={class:"card-body"},rs={class:"d-flex align-items-center"},cs={class:"flex-grow-1 ms-3"},us={class:"mb-0"},ms={class:"col-md-3"},bs={class:"card border-0 shadow-sm bg-danger text-white"},gs={class:"card-body"},vs={class:"d-flex align-items-center"},hs={class:"flex-grow-1 ms-3"},ps={class:"mb-0"},fs={class:"col-md-3"},_s={class:"card border-0 shadow-sm bg-dark text-white"},xs={class:"card-body"},ys={class:"d-flex align-items-center"},ws={class:"flex-grow-1 ms-3"},ks={class:"mb-0"},Cs={class:"card mb-4"},Ms={class:"card-body"},Ps={class:"col-md-4"},Vs={class:"col-md-3"},Bs={class:"col-md-2 d-flex align-items-end"},Ns={class:"card"},$s={class:"card-body"},zs={class:"table-responsive"},Ss={class:"table table-hover align-middle"},Ts={key:0},js={class:"text-muted"},Fs={class:"text-end"},Os={class:"text-center"},As={class:"badge bg-info"},Ds={class:"text-end text-success"},Es={class:"text-end text-danger"},Is={class:"text-center"},Us={key:0,class:"badge bg-danger"},Gs={key:1,class:"text-muted"},Ls={class:"text-center"},Rs={class:"text-center"},qs={class:"btn-group btn-group-sm"},Ws=["onClick"],Hs={key:0,class:"mt-4"},Js={class:"pagination justify-content-center"},Ks={key:1,class:"page-link"},ot={__name:"Index",props:{creditos:Object,indicadores:Object,filtros:Object,metodosPago:Array},setup(l){var P,V;const _=l,m=C({search:((P=_.filtros)==null?void 0:P.search)||"",estado:((V=_.filtros)==null?void 0:V.estado)||""}),y=C(!1),w=C([]),A=a=>{w.value=a.cuotas||[],y.value=!0},D=()=>{y.value=!1,w.value=[]},h=a=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB",minimumFractionDigits:2}).format(a),E=a=>({pendiente:"badge bg-warning",pagado:"badge bg-success",vencido:"badge bg-danger"})[a]||"badge bg-secondary",I=a=>{var t;return((t=a.cuotas)==null?void 0:t.filter(r=>r.estado==="pagado").length)||0},M=()=>{H.get(route("creditos.index"),m.value,{preserveState:!0,preserveScroll:!0})},U=()=>{m.value={search:"",estado:""},M()},G=L(()=>{const a=_.creditos.current_page,t=_.creditos.last_page,r=2,p=[],e=[];for(let c=Math.max(2,a-r);c<=Math.min(t-1,a+r);c++)p.push(c);return a-r>2?e.push(1,"..."):e.push(1),e.push(...p),a+r<t-1?e.push("...",t):t>1&&e.push(t),e});return(a,t)=>(i(),T(J,{title:"Gestión de Créditos"},{default:u(()=>{var r,p;return[s("div",Q,[t[26]||(t[26]=s("div",{class:"row mb-4"},[s("div",{class:"col-lg-8"},[s("h2",{class:"mb-0"},[s("i",{class:"bi bi-credit-card me-2"}),d("Gestión de Créditos ")]),s("p",{class:"text-muted"}," Administra y visualiza los créditos otorgados a clientes ")]),s("div",{class:"col-lg-4 text-end"})],-1)),(r=a.$page.props.flash)!=null&&r.success?(i(),n("div",X,[t[2]||(t[2]=s("i",{class:"bi bi-check-circle me-2"},null,-1)),d(" "+o(a.$page.props.flash.success)+" ",1),t[3]||(t[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):f("",!0),(p=a.$page.props.errors)!=null&&p.error?(i(),n("div",Y,[t[4]||(t[4]=s("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),d(" "+o(a.$page.props.errors.error)+" ",1),t[5]||(t[5]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):f("",!0),s("div",Z,[s("div",ss,[s("div",ts,[s("div",es,[s("div",as,[t[7]||(t[7]=s("div",{class:"flex-shrink-0"},[s("div",{class:"bg-white bg-opacity-10 rounded p-3"},[s("i",{class:"bi bi-collection text-white",style:{"font-size":"1.5rem"}})])],-1)),s("div",os,[t[6]||(t[6]=s("div",{class:"text-white small"},"Total Créditos",-1)),s("h3",ls,o(l.indicadores.total_creditos),1)])])])])]),s("div",is,[s("div",ns,[s("div",ds,[s("div",rs,[t[9]||(t[9]=s("div",{class:"flex-shrink-0"},[s("div",{class:"bg-white bg-opacity-10 rounded p-3"},[s("i",{class:"bi bi-cash-coin text-warning",style:{"font-size":"1.5rem"}})])],-1)),s("div",cs,[t[8]||(t[8]=s("div",{class:"text-dark small"},"Total Pendiente",-1)),s("h3",us,o(h(l.indicadores.total_pendiente)),1)])])])])]),s("div",ms,[s("div",bs,[s("div",gs,[s("div",vs,[t[11]||(t[11]=s("div",{class:"flex-shrink-0"},[s("div",{class:"bg-white bg-opacity-10 rounded p-3"},[s("i",{class:"bi bi-exclamation-octagon text-danger",style:{"font-size":"1.5rem"}})])],-1)),s("div",hs,[t[10]||(t[10]=s("div",{class:"text-white small"},"Créditos en Mora",-1)),s("h3",ps,o(l.indicadores.total_mora),1)])])])])]),s("div",fs,[s("div",_s,[s("div",xs,[s("div",ys,[t[13]||(t[13]=s("div",{class:"flex-shrink-0"},[s("div",{class:"bg-white bg-opacity-10 rounded p-3"},[s("i",{class:"bi bi-currency-exchange text-white",style:{"font-size":"1.5rem"}})])],-1)),s("div",ws,[t[12]||(t[12]=s("div",{class:"text-white small"},"Monto en Mora",-1)),s("h3",ks,o(h(l.indicadores.monto_mora)),1)])])])])])]),s("div",Cs,[s("div",Ms,[s("form",{onSubmit:R(M,["prevent"]),class:"row g-3"},[s("div",Ps,[t[14]||(t[14]=s("label",{class:"form-label"},"Buscar",-1)),j(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>m.value.search=e),type:"text",class:"form-control",placeholder:"Cliente, CI, N° Venta..."},null,512),[[q,m.value.search]])]),s("div",Vs,[t[16]||(t[16]=s("label",{class:"form-label"},"Estado",-1)),j(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>m.value.estado=e),class:"form-select"},[...t[15]||(t[15]=[s("option",{value:""},"Todos",-1),s("option",{value:"pendiente"},"Pendiente",-1),s("option",{value:"pagado"},"Pagado",-1),s("option",{value:"vencido"},"Vencido",-1)])],512),[[W,m.value.estado]])]),s("div",{class:"col-md-3 d-flex align-items-end"},[t[18]||(t[18]=s("button",{type:"submit",class:"btn btn-primary me-2"},[s("i",{class:"bi bi-search"}),d(" Buscar ")],-1)),s("button",{type:"button",onClick:U,class:"btn btn-secondary"},[...t[17]||(t[17]=[s("i",{class:"bi bi-x-circle"},null,-1),d(" Limpiar ",-1)])])]),s("div",Bs,[b(g(v),{href:a.route("creditos.reporte-mora"),class:"btn btn-danger w-100"},{default:u(()=>[...t[19]||(t[19]=[s("i",{class:"bi bi-file-earmark-text"},null,-1),d(" Reporte Mora ",-1)])]),_:1},8,["href"])])],32)])]),s("div",Ns,[s("div",$s,[s("div",zs,[s("table",Ss,[t[23]||(t[23]=s("thead",{class:"table-light"},[s("tr",null,[s("th",null,"N° Crédito"),s("th",null,"Cliente"),s("th",null,"Venta"),s("th",{class:"text-end"},"Monto Total"),s("th",{class:"text-center"},"Cuotas"),s("th",{class:"text-end"},"Pagado"),s("th",{class:"text-end"},"Pendiente"),s("th",{class:"text-center"},"Mora"),s("th",{class:"text-center"},"Estado"),s("th",{class:"text-center"},"Acciones")])],-1)),s("tbody",null,[l.creditos.data.length===0?(i(),n("tr",Ts,[...t[20]||(t[20]=[s("td",{colspan:"10",class:"text-center text-muted py-4"},[s("i",{class:"bi bi-inbox fs-1 d-block mb-2"}),d(" No se encontraron créditos ")],-1)])])):f("",!0),(i(!0),n(F,null,O(l.creditos.data,e=>{var c,B,N,$,z,S;return i(),n("tr",{key:e.id},[s("td",null,[s("strong",null,"#"+o(e.id),1)]),s("td",null,[s("div",null,[s("strong",null,o((B=(c=e.venta)==null?void 0:c.user)==null?void 0:B.nombre),1),d(" "+o(($=(N=e.venta)==null?void 0:N.user)==null?void 0:$.apellidos),1)]),s("small",js,"CI: "+o((S=(z=e.venta)==null?void 0:z.user)==null?void 0:S.ci),1)]),s("td",null,[b(g(v),{href:a.route("ventas.show",e.venta_id),class:"text-primary"},{default:u(()=>{var k;return[d(o((k=e.venta)==null?void 0:k.numero_venta),1)]}),_:2},1032,["href"])]),s("td",Fs,o(h(e.monto_credito)),1),s("td",Os,[s("span",As,o(I(e))+"/"+o(e.cuotas_total),1)]),s("td",Ds,o(h(e.monto_pagado)),1),s("td",Es,o(h(e.monto_pendiente)),1),s("td",Is,[e.dias_mora>0?(i(),n("span",Us,o(e.dias_mora)+" días ",1)):(i(),n("span",Gs,"-"))]),s("td",Ls,[s("span",{class:x(E(e.estado))},o(e.estado.toUpperCase()),3)]),s("td",Rs,[s("div",qs,[b(g(v),{href:a.route("creditos.show",e.id),class:"btn btn-outline-info",title:"Ver detalles"},{default:u(()=>[...t[21]||(t[21]=[s("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),e.estado!=="pagado"?(i(),n("button",{key:0,onClick:k=>A(e),class:"btn btn-outline-success",title:"Registrar pago"},[...t[22]||(t[22]=[s("i",{class:"bi bi-cash-coin"},null,-1)])],8,Ws)):f("",!0)])])])}),128))])])]),l.creditos.last_page>1?(i(),n("div",Hs,[s("nav",null,[s("ul",Js,[s("li",{class:x(["page-item",{disabled:!l.creditos.prev_page_url}])},[b(g(v),{class:"page-link",href:l.creditos.prev_page_url||"#","preserve-state":""},{default:u(()=>[...t[24]||(t[24]=[d(" Anterior ",-1)])]),_:1},8,["href"])],2),(i(!0),n(F,null,O(G.value,e=>{var c;return i(),n("li",{key:e,class:x(["page-item",{active:e===l.creditos.current_page}])},[e!=="..."?(i(),T(g(v),{key:0,class:"page-link",href:((c=l.creditos.links[e])==null?void 0:c.url)||"#","preserve-state":""},{default:u(()=>[d(o(e),1)]),_:2},1032,["href"])):(i(),n("span",Ks,"..."))],2)}),128)),s("li",{class:x(["page-item",{disabled:!l.creditos.next_page_url}])},[b(g(v),{class:"page-link",href:l.creditos.next_page_url||"#","preserve-state":""},{default:u(()=>[...t[25]||(t[25]=[d(" Siguiente ",-1)])]),_:1},8,["href"])],2)])])])):f("",!0)])])]),b(K,{show:y.value,cuotas:w.value,metodosPago:l.metodosPago,onClose:D},null,8,["show","cuotas","metodosPago"])]}),_:1}))}};export{ot as default};
