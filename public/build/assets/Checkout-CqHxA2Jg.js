import{h as V,T as z,r as y,g as P,w as v,b as s,c as r,f as n,o as l,e as u,t as i,F as k,m as h,d as $,a as I,j as c,n as b,u as o,q as w,p as f,i as S}from"./app-BM_Csk7S.js";import{_ as T}from"./AppLayout-Aol2IiYi.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"py-12"},N={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},U={key:0,class:"alert alert-danger alert-dismissible fade show mb-4",role:"alert"},j={class:"row"},B={class:"col-lg-8"},A={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg mb-4"},q={class:"p-4"},E={class:"row align-items-center"},L={class:"col-md-7"},O={class:"font-semibold mb-1"},R={class:"text-sm text-gray-600 mb-0"},G={key:0,class:"badge bg-success"},H={class:"col-md-5 text-end"},J={class:"font-semibold mb-0"},K={class:"col-lg-4"},Q={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg sticky-top",style:{top:"20px"}},W={class:"mb-3"},X={key:0,class:"invalid-feedback"},Y={class:"mb-3"},Z=["value"],ss={key:0,class:"invalid-feedback"},es={key:0,class:"border-top pt-3 mt-3"},ts={class:"mb-3"},os={key:0,class:"invalid-feedback"},as={class:"mb-3"},ls={key:0,class:"invalid-feedback"},is={class:"mb-3"},rs=["min"],ns={key:0,class:"invalid-feedback"},ds={key:0,class:"alert alert-info"},ms={class:"mb-1"},ps={class:"mb-0 text-sm"},us={class:"mb-4"},cs={class:"d-flex justify-content-between mb-2"},bs={key:0,class:"d-flex justify-content-between mb-2 text-info"},_s={class:"d-flex justify-content-between"},vs={class:"font-semibold text-primary"},fs=["disabled"],gs={key:0},xs={key:1},ys={__name:"Checkout",props:{detalles:Array,total:Number,metodosPago:Array},setup(p){const g=p,C=V(()=>{const d=new Date;return d.setDate(d.getDate()+1),d.toISOString().split("T")[0]}),t=z({metodo_pago_id:"",tipo_venta:"contado",meses_plazo:12,tasa_interes:10,fecha_primer_pago:""}),_=y(0),m=y(0),x=()=>{if(t.tipo_venta==="credito"&&t.meses_plazo>0&&t.tasa_interes>=0){const d=g.total*t.tasa_interes/100;m.value=g.total+d,_.value=m.value/t.meses_plazo}else _.value=0,m.value=0},F=()=>{t.post(route("pedidos.store"),{preserveScroll:!0})};return(d,e)=>(l(),P(T,{title:"Checkout"},{header:v(()=>[...e[5]||(e[5]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},[s("i",{class:"bi bi-credit-card me-2"}),u("Finalizar Compra ")],-1)])]),default:v(()=>[s("div",M,[s("div",N,[d.$page.props.errors.stock?(l(),r("div",U,[e[6]||(e[6]=s("i",{class:"bi bi-x-circle me-2"},null,-1)),u(i(d.$page.props.errors.stock)+" ",1),e[7]||(e[7]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):n("",!0),s("div",j,[s("div",B,[s("div",A,[e[8]||(e[8]=s("div",{class:"p-4 border-b border-gray-200"},[s("h4",{class:"font-semibold text-lg"}," Resumen de Productos ")],-1)),s("div",q,[(l(!0),r(k,null,h(p.detalles,a=>(l(),r("div",{key:a.producto.id,class:"border-b pb-3 mb-3 last:border-b-0"},[s("div",E,[s("div",L,[s("h6",O,i(a.producto.nombre),1),s("p",R," Cantidad: "+i(a.cantidad)+" × $"+i(a.precio_unitario.toFixed(2)),1),a.descuento>0?(l(),r("span",G," Descuento: $"+i(a.descuento.toFixed(2)),1)):n("",!0)]),s("div",H,[s("p",J," $"+i(a.subtotal.toFixed(2)),1)])])]))),128))])])]),s("div",K,[s("div",Q,[e[25]||(e[25]=s("div",{class:"p-4 border-b border-gray-200"},[s("h4",{class:"font-semibold text-lg"}," Método de Pago ")],-1)),s("form",{onSubmit:$(F,["prevent"]),class:"p-4"},[s("div",W,[e[10]||(e[10]=s("label",{class:"form-label fw-semibold"},"Tipo de Venta",-1)),c(s("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).tipo_venta=a),class:b(["form-select",{"is-invalid":o(t).errors.tipo_venta}])},[...e[9]||(e[9]=[s("option",{value:"contado"},"Contado",-1),s("option",{value:"credito"},"Crédito",-1)])],2),[[w,o(t).tipo_venta]]),o(t).errors.tipo_venta?(l(),r("div",X,i(o(t).errors.tipo_venta),1)):n("",!0)]),s("div",Y,[e[12]||(e[12]=s("label",{class:"form-label fw-semibold"},"Método de Pago",-1)),c(s("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).metodo_pago_id=a),class:b(["form-select",{"is-invalid":o(t).errors.metodo_pago_id}])},[e[11]||(e[11]=s("option",{value:""},"Seleccione...",-1)),(l(!0),r(k,null,h(p.metodosPago,a=>(l(),r("option",{key:a.id,value:a.id},i(a.nombre),9,Z))),128))],2),[[w,o(t).metodo_pago_id]]),o(t).errors.metodo_pago_id?(l(),r("div",ss,i(o(t).errors.metodo_pago_id),1)):n("",!0)]),o(t).tipo_venta==="credito"?(l(),r("div",es,[e[17]||(e[17]=s("h6",{class:"font-semibold mb-3"}," Información del Crédito ",-1)),s("div",ts,[e[13]||(e[13]=s("label",{class:"form-label"},"Meses de Plazo",-1)),c(s("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=a=>o(t).meses_plazo=a),class:b(["form-control",{"is-invalid":o(t).errors.meses_plazo}]),min:"1",max:"36",onInput:x},null,34),[[f,o(t).meses_plazo]]),o(t).errors.meses_plazo?(l(),r("div",os,i(o(t).errors.meses_plazo),1)):n("",!0)]),s("div",as,[e[14]||(e[14]=s("label",{class:"form-label"},"Tasa de Interés (%)",-1)),c(s("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>o(t).tasa_interes=a),class:b(["form-control",{"is-invalid":o(t).errors.tasa_interes}]),min:"0",max:"100",step:"0.1",onInput:x},null,34),[[f,o(t).tasa_interes]]),o(t).errors.tasa_interes?(l(),r("div",ls,i(o(t).errors.tasa_interes),1)):n("",!0)]),s("div",is,[e[15]||(e[15]=s("label",{class:"form-label"},"Fecha Primer Pago",-1)),c(s("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=a=>o(t).fecha_primer_pago=a),class:b(["form-control",{"is-invalid":o(t).errors.fecha_primer_pago}]),min:C.value},null,10,rs),[[f,o(t).fecha_primer_pago]]),o(t).errors.fecha_primer_pago?(l(),r("div",ns,i(o(t).errors.fecha_primer_pago),1)):n("",!0)]),_.value>0?(l(),r("div",ds,[s("p",ms,[e[16]||(e[16]=s("strong",null,"Cuota mensual:",-1)),u(" $"+i(_.value.toFixed(2)),1)]),s("p",ps," Total con interés: $"+i(m.value.toFixed(2)),1)])):n("",!0)])):n("",!0),e[24]||(e[24]=s("hr",null,null,-1)),s("div",us,[s("div",cs,[e[18]||(e[18]=s("span",null,"Subtotal:",-1)),s("span",null,"$"+i(p.total.toFixed(2)),1)]),o(t).tipo_venta==="credito"&&m.value>0?(l(),r("div",bs,[e[19]||(e[19]=s("span",null,"Interés:",-1)),s("span",null,"+$"+i((m.value-p.total).toFixed(2)),1)])):n("",!0),s("div",_s,[e[20]||(e[20]=s("h5",{class:"font-semibold"}," Total a Pagar: ",-1)),s("h5",vs," $"+i(o(t).tipo_venta==="credito"?m.value.toFixed(2):p.total.toFixed(2)),1)])]),s("button",{type:"submit",class:"btn btn-success w-100 mb-2",disabled:o(t).processing},[o(t).processing?(l(),r("span",gs,[...e[21]||(e[21]=[s("span",{class:"spinner-border spinner-border-sm me-2"},null,-1),u(" Procesando... ",-1)])])):(l(),r("span",xs,[...e[22]||(e[22]=[s("i",{class:"bi bi-check-circle me-2"},null,-1),u("Confirmar Compra ",-1)])]))],8,fs),I(o(S),{href:d.route("carritos.index"),class:"btn btn-outline-secondary w-100"},{default:v(()=>[...e[23]||(e[23]=[s("i",{class:"bi bi-arrow-left me-2"},null,-1),u("Volver al Carrito ",-1)])]),_:1},8,["href"])],32)])])])])])]),_:1}))}},Cs=D(ys,[["__scopeId","data-v-450224c1"]]);export{Cs as default};
