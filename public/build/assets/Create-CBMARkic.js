import{T as j,r as w,h as A,c as l,a as h,u as t,Z as B,w as C,b as s,i as $,e as r,d as L,j as c,f as p,n as _,p as v,o as n,t as d,v as y,F as k,m as g}from"./app-DTocK5dB.js";import{_ as I}from"./AppLayout-ChHXXbMF.js";import{F as E}from"./FlashNotification-BbasMMB-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"container py-4"},T={class:"row mb-4"},z={class:"col-lg-12"},R={class:"d-flex justify-content-between align-items-center"},Z={class:"row"},q={class:"col-lg-8 mx-auto"},H={class:"card mb-4"},J={class:"card-body"},K={class:"row g-3"},O={class:"col-md-8"},Q={key:0,class:"invalid-feedback"},W={class:"col-md-4"},X={key:0,class:"invalid-feedback"},Y={class:"col-md-12"},ss={key:0,class:"invalid-feedback"},es={class:"col-md-6"},os={key:0,class:"invalid-feedback"},is={class:"col-md-6"},ts={key:0,class:"invalid-feedback"},as={class:"col-md-12"},ls={class:"form-check form-switch"},ns={class:"form-check-label",for:"estado"},rs={class:"card mb-4"},ds={class:"card-body"},cs={class:"mb-3"},ms={class:"row g-2 mb-3"},us=["onClick"],bs={key:0},ps={key:1},_s={class:"d-flex justify-content-between align-items-start mb-2"},fs=["onClick"],vs={class:"d-flex gap-3"},hs={class:"form-check"},ys=["onUpdate:modelValue","id"],ks=["for"],xs={class:"form-check"},gs=["onUpdate:modelValue","id"],ws=["for"],Cs={key:2,class:"text-muted text-center mb-0"},Vs={class:"card mb-4"},Us={class:"card-body"},Ps={class:"row g-2 mb-3"},$s=["onClick"],Fs={key:0},Ns={key:1},Ss={class:"fw-bold mb-2"},Ms={class:"d-flex gap-3"},Ds={class:"form-check"},js=["onUpdate:modelValue","id"],As=["for"],Bs={class:"form-check"},Ls=["onUpdate:modelValue","id"],Is=["for"],Es={key:2,class:"text-muted text-center mb-0"},Gs={class:"card"},Ts={class:"card-body"},zs={class:"d-flex gap-2 justify-content-end"},Rs=["disabled"],Zs={key:0},qs={key:1},Qs={__name:"Create",props:{productos:Array,categorias:Array},setup(V){const U=V,i=j({nombre:"",descripcion:"",valor_descuento_decimal:"",fecha_inicio:"",fecha_fin:"",estado:!0,productos:[],categorias:[]}),f=w(""),F=A(()=>f.value?U.productos.filter(a=>a.nombre.toLowerCase().includes(f.value.toLowerCase())||a.codigo.toLowerCase().includes(f.value.toLowerCase())):U.productos),u=w([]),N=a=>{u.value.find(e=>e.id===a.id)||u.value.push({id:a.id,nombre:a.nombre,codigo:a.codigo,aplica_mayorista:!1,aplica_minorista:!1}),f.value=""},S=a=>{u.value.splice(a,1)},m=w([]),M=a=>{const e=m.value.findIndex(o=>o.id===a.id);e>-1?m.value.splice(e,1):m.value.push({id:a.id,nombre:a.nombre,aplica_mayorista:!1,aplica_minorista:!1})},P=a=>m.value.some(e=>e.id===a),D=()=>{i.productos=u.value.map(a=>({id:a.id,aplica_mayorista:a.aplica_mayorista,aplica_minorista:a.aplica_minorista})),i.categorias=m.value.map(a=>({id:a.id,aplica_mayorista:a.aplica_mayorista,aplica_minorista:a.aplica_minorista})),i.post(route("promociones.store"),{preserveScroll:!0})};return(a,e)=>(n(),l(k,null,[h(t(B),{title:"Crear Promoción"}),h(I,{title:"Crear Promoción"},{default:C(()=>[h(E),s("div",G,[s("div",T,[s("div",z,[s("div",R,[e[8]||(e[8]=s("div",null,[s("h2",{class:"mb-0"},"Crear Promoción"),s("p",{class:"text-muted"}," Registra una nueva oferta o descuento ")],-1)),h(t($),{href:a.route("promociones.index"),class:"btn btn-outline-secondary"},{default:C(()=>[...e[7]||(e[7]=[s("i",{class:"bi bi-arrow-left me-2"},null,-1),r(" Volver ",-1)])]),_:1},8,["href"])])])]),s("form",{onSubmit:L(D,["prevent"])},[s("div",Z,[s("div",q,[s("div",H,[e[14]||(e[14]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Información General")],-1)),s("div",J,[s("div",K,[s("div",O,[e[9]||(e[9]=s("label",{class:"form-label"},[r("Nombre "),s("span",{class:"text-danger"},"*")],-1)),c(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t(i).nombre=o),type:"text",class:_(["form-control",{"is-invalid":t(i).errors.nombre}]),placeholder:"Ej: Descuento Navidad 2025"},null,2),[[v,t(i).nombre]]),t(i).errors.nombre?(n(),l("div",Q,d(t(i).errors.nombre),1)):p("",!0)]),s("div",W,[e[10]||(e[10]=s("label",{class:"form-label"},[r("Descuento (%) "),s("span",{class:"text-danger"},"*")],-1)),c(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t(i).valor_descuento_decimal=o),type:"number",step:"0.01",min:"0",max:"100",class:_(["form-control",{"is-invalid":t(i).errors.valor_descuento_decimal}]),placeholder:"15"},null,2),[[v,t(i).valor_descuento_decimal]]),t(i).errors.valor_descuento_decimal?(n(),l("div",X,d(t(i).errors.valor_descuento_decimal),1)):p("",!0)]),s("div",Y,[e[11]||(e[11]=s("label",{class:"form-label"},"Descripción",-1)),c(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>t(i).descripcion=o),class:_(["form-control",{"is-invalid":t(i).errors.descripcion}]),rows:"2",placeholder:"Descripción opcional de la promoción"},null,2),[[v,t(i).descripcion]]),t(i).errors.descripcion?(n(),l("div",ss,d(t(i).errors.descripcion),1)):p("",!0)]),s("div",es,[e[12]||(e[12]=s("label",{class:"form-label"},[r("Fecha Inicio "),s("span",{class:"text-danger"},"*")],-1)),c(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>t(i).fecha_inicio=o),type:"date",class:_(["form-control",{"is-invalid":t(i).errors.fecha_inicio}])},null,2),[[v,t(i).fecha_inicio]]),t(i).errors.fecha_inicio?(n(),l("div",os,d(t(i).errors.fecha_inicio),1)):p("",!0)]),s("div",is,[e[13]||(e[13]=s("label",{class:"form-label"},[r("Fecha Fin "),s("span",{class:"text-danger"},"*")],-1)),c(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>t(i).fecha_fin=o),type:"date",class:_(["form-control",{"is-invalid":t(i).errors.fecha_fin}])},null,2),[[v,t(i).fecha_fin]]),t(i).errors.fecha_fin?(n(),l("div",ts,d(t(i).errors.fecha_fin),1)):p("",!0)]),s("div",as,[s("div",ls,[c(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>t(i).estado=o),class:"form-check-input",type:"checkbox",id:"estado",role:"switch"},null,512),[[y,t(i).estado]]),s("label",ns,d(t(i).estado?"Activa":"Inactiva"),1)])])])])]),s("div",rs,[e[20]||(e[20]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"}," Aplicar a Productos Específicos ")],-1)),s("div",ds,[s("div",cs,[e[15]||(e[15]=s("label",{class:"form-label"},"Buscar Producto",-1)),c(s("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>f.value=o),type:"text",class:"form-control",placeholder:"Buscar por nombre o código..."},null,512),[[v,f.value]])]),s("div",ms,[(n(!0),l(k,null,g(F.value.slice(0,10),o=>(n(),l("div",{key:o.id,class:"col-md-6"},[s("button",{type:"button",class:"btn btn-sm btn-outline-primary w-100 text-start",onClick:b=>N(o)},[e[16]||(e[16]=s("i",{class:"bi bi-plus-circle me-1"},null,-1)),r(" "+d(o.codigo)+" - "+d(o.nombre),1)],8,us)]))),128))]),u.value.length>0?(n(),l("hr",bs)):p("",!0),u.value.length>0?(n(),l("div",ps,[e[18]||(e[18]=s("label",{class:"form-label fw-bold"},"Productos Seleccionados:",-1)),(n(!0),l(k,null,g(u.value,(o,b)=>(n(),l("div",{key:o.id,class:"border rounded p-3 mb-2"},[s("div",_s,[s("div",null,[s("strong",null,d(o.codigo),1),r(" - "+d(o.nombre),1)]),s("button",{type:"button",class:"btn btn-sm btn-danger",onClick:x=>S(b)},[...e[17]||(e[17]=[s("i",{class:"bi bi-trash"},null,-1)])],8,fs)]),s("div",vs,[s("div",hs,[c(s("input",{"onUpdate:modelValue":x=>o.aplica_minorista=x,class:"form-check-input",type:"checkbox",id:`prod-minorista-${o.id}`},null,8,ys),[[y,o.aplica_minorista]]),s("label",{class:"form-check-label",for:`prod-minorista-${o.id}`}," Precio Minorista ",8,ks)]),s("div",xs,[c(s("input",{"onUpdate:modelValue":x=>o.aplica_mayorista=x,class:"form-check-input",type:"checkbox",id:`prod-mayorista-${o.id}`},null,8,gs),[[y,o.aplica_mayorista]]),s("label",{class:"form-check-label",for:`prod-mayorista-${o.id}`}," Precio Mayorista ",8,ws)])])]))),128))])):(n(),l("p",Cs,[...e[19]||(e[19]=[s("i",{class:"bi bi-inbox"},null,-1),r(" No hay productos seleccionados ",-1)])]))])]),s("div",Vs,[e[23]||(e[23]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"}," Aplicar a Categorías Completas ")],-1)),s("div",Us,[s("div",Ps,[(n(!0),l(k,null,g(V.categorias,o=>(n(),l("div",{key:o.id,class:"col-md-6"},[s("button",{type:"button",class:_(["btn btn-sm w-100 text-start",P(o.id)?"btn-success":"btn-outline-secondary"]),onClick:b=>M(o)},[s("i",{class:_(["bi me-1",P(o.id)?"bi-check-circle-fill":"bi-circle"])},null,2),r(" "+d(o.nombre),1)],10,$s)]))),128))]),m.value.length>0?(n(),l("hr",Fs)):p("",!0),m.value.length>0?(n(),l("div",Ns,[e[21]||(e[21]=s("label",{class:"form-label fw-bold"},"Categorías Seleccionadas:",-1)),(n(!0),l(k,null,g(m.value,o=>(n(),l("div",{key:o.id,class:"border rounded p-3 mb-2 bg-light"},[s("div",Ss,d(o.nombre),1),s("div",Ms,[s("div",Ds,[c(s("input",{"onUpdate:modelValue":b=>o.aplica_minorista=b,class:"form-check-input",type:"checkbox",id:`cat-minorista-${o.id}`},null,8,js),[[y,o.aplica_minorista]]),s("label",{class:"form-check-label",for:`cat-minorista-${o.id}`}," Precio Minorista ",8,As)]),s("div",Bs,[c(s("input",{"onUpdate:modelValue":b=>o.aplica_mayorista=b,class:"form-check-input",type:"checkbox",id:`cat-mayorista-${o.id}`},null,8,Ls),[[y,o.aplica_mayorista]]),s("label",{class:"form-check-label",for:`cat-mayorista-${o.id}`}," Precio Mayorista ",8,Is)])])]))),128))])):(n(),l("p",Es,[...e[22]||(e[22]=[s("i",{class:"bi bi-inbox"},null,-1),r(" No hay categorías seleccionadas ",-1)])]))])]),s("div",Gs,[s("div",Ts,[s("div",zs,[h(t($),{href:a.route("promociones.index"),class:"btn btn-secondary"},{default:C(()=>[...e[24]||(e[24]=[r(" Cancelar ",-1)])]),_:1},8,["href"]),s("button",{type:"submit",class:"btn btn-primary",disabled:t(i).processing},[t(i).processing?(n(),l("span",Zs,[...e[25]||(e[25]=[s("i",{class:"bi bi-hourglass-split me-2"},null,-1),r(" Guardando... ",-1)])])):(n(),l("span",qs,[...e[26]||(e[26]=[s("i",{class:"bi bi-save me-2"},null,-1),r(" Guardar Promoción ",-1)])]))],8,Rs)])])])])])],32)])]),_:1})],64))}};export{Qs as default};
