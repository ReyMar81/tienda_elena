import{r as N,T as S,g as F,w as p,b as s,c as n,f as u,o as a,e as i,t as o,a as x,u as d,i as y,F as P,m as j,d as z,j as D,p as I,N as f}from"./app-9HEqLJnm.js";import{_ as M}from"./AppLayout-DD1QV7aw.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"py-12"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},B={key:0,class:"alert alert-success alert-dismissible fade show mb-4",role:"alert"},R={key:1,class:"alert alert-danger alert-dismissible fade show mb-4",role:"alert"},L={key:2,class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},A={class:"p-6 text-center"},Q={key:3,class:"row"},q={class:"col-lg-8"},O={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg mb-4"},U={class:"p-4 border-b border-gray-200"},Z={class:"font-semibold text-lg"},G={class:"p-4"},H={class:"row align-items-center"},J={class:"col-md-2"},K=["src","alt"],W={class:"col-md-4"},X={class:"font-semibold"},Y={class:"text-sm text-gray-600"},ss={key:0},ts={class:"text-sm text-gray-600"},es={class:"col-md-2"},os={key:0},ls={class:"text-sm text-decoration-line-through text-gray-500"},as={class:"font-semibold text-success"},ns={class:"badge bg-danger"},is={key:1},rs={class:"font-semibold"},ds={class:"col-md-2"},cs={class:"input-group"},us=["onClick","disabled"],bs=["value","onChange","max"],ms=["onClick","disabled"],ps={class:"col-md-2 text-end"},gs={class:"font-semibold text-lg mb-2"},fs=["onClick"],vs={class:"col-lg-4"},_s={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg sticky-top",style:{top:"20px"}},xs={class:"p-4"},ys={class:"mb-3"},hs={class:"d-flex justify-content-between mb-2"},ks={class:"d-flex justify-content-between mb-2"},ws={key:0,class:"d-flex justify-content-between mb-2 text-success"},Cs={class:"d-flex justify-content-between mb-4"},$s={class:"font-semibold text-primary"},Ns={key:0,class:"modal fade show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},Ss={class:"modal-dialog modal-dialog-centered"},Fs={class:"modal-content"},Ps={class:"modal-header"},js={class:"modal-body"},zs={class:"mb-3"},Ds={key:0,class:"text-danger small mt-1"},Is={class:"alert alert-warning"},Ms={class:"mb-2"},Ts={class:"modal-footer"},Vs=["disabled"],Es=["disabled"],Bs={key:0},Rs={key:1},Ls={__name:"Index",props:{carrito:Object,detalles:Array,total:Number},setup(c){const v=c,b=N(!1),r=S({direccion_entrega:""}),h=()=>v.detalles.reduce((l,t)=>l+t.precio_unitario*t.cantidad,0),_=()=>v.detalles.reduce((l,t)=>l+t.descuento_monto*t.cantidad,0),g=(l,t)=>{const e=parseInt(t);e<1||e>l.producto.stock_actual||f.put(route("carritos.update",l.id),{cantidad:e},{preserveScroll:!0})},k=l=>{confirm("¿Estás seguro de eliminar este producto del carrito?")&&f.delete(route("carritos.destroy",l),{preserveScroll:!0})},w=()=>{confirm("¿Estás seguro de vaciar todo el carrito?")&&f.delete(route("carritos.vaciar"),{preserveScroll:!0})},C=()=>{b.value=!0},$=()=>{r.post(route("carrito.realizar-pedido"),{preserveScroll:!1,onSuccess:()=>{b.value=!1,r.reset()}})};return(l,t)=>(a(),F(M,{title:"Mi Carrito"},{header:p(()=>[...t[3]||(t[3]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},[s("i",{class:"bi bi-cart-fill me-2"}),i("Mi Carrito ")],-1)])]),default:p(()=>[s("div",V,[s("div",E,[l.$page.props.flash.success?(a(),n("div",B,[t[4]||(t[4]=s("i",{class:"bi bi-check-circle me-2"},null,-1)),i(o(l.$page.props.flash.success)+" ",1),t[5]||(t[5]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):u("",!0),l.$page.props.flash.error?(a(),n("div",R,[t[6]||(t[6]=s("i",{class:"bi bi-x-circle me-2"},null,-1)),i(o(l.$page.props.flash.error)+" ",1),t[7]||(t[7]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):u("",!0),!c.carrito||c.detalles.length===0?(a(),n("div",L,[s("div",A,[t[9]||(t[9]=s("i",{class:"bi bi-cart-x",style:{"font-size":"5rem",color:"#6c757d"}},null,-1)),t[10]||(t[10]=s("h3",{class:"mt-3 text-xl font-semibold text-gray-700"}," Tu carrito está vacío ",-1)),t[11]||(t[11]=s("p",{class:"mt-2 text-gray-600"}," Agrega productos para comenzar tu compra ",-1)),x(d(y),{href:l.route("dashboard"),class:"btn btn-primary mt-4"},{default:p(()=>[...t[8]||(t[8]=[s("i",{class:"bi bi-box-seam me-2"},null,-1),i("Ver Productos ",-1)])]),_:1},8,["href"])])])):(a(),n("div",Q,[s("div",q,[s("div",O,[s("div",U,[s("h4",Z," Productos ("+o(c.detalles.length)+") ",1)]),s("div",G,[(a(!0),n(P,null,j(c.detalles,e=>(a(),n("div",{key:e.id,class:"border-b pb-4 mb-4 last:border-b-0"},[s("div",H,[s("div",J,[s("img",{src:e.producto.imagenes&&e.producto.imagenes.length>0?`/storage/${e.producto.imagenes[0].url}`:"/images/no-image.png",alt:e.producto.nombre,class:"img-fluid rounded",style:{"max-height":"100px","object-fit":"cover"}},null,8,K)]),s("div",W,[s("h5",X,o(e.producto.nombre),1),s("p",Y,[e.producto.categoria?(a(),n("span",ss,[t[12]||(t[12]=s("i",{class:"bi bi-tag me-1"},null,-1)),i(o(e.producto.categoria.nombre),1)])):u("",!0)]),s("p",ts," Stock: "+o(e.producto.stock_actual),1)]),s("div",es,[e.descuento_porcentaje>0?(a(),n("div",os,[s("p",ls," $"+o(Number(e.precio_unitario).toFixed(2)),1),s("p",as," $"+o(Number(e.precio_con_descuento).toFixed(2)),1),s("span",ns," -"+o(e.descuento_porcentaje)+"% ",1)])):(a(),n("div",is,[s("p",rs," $"+o(Number(e.precio_unitario).toFixed(2)),1)]))]),s("div",ds,[s("div",cs,[s("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:m=>g(e,e.cantidad-1),disabled:e.cantidad<=1},[...t[13]||(t[13]=[s("i",{class:"bi bi-dash"},null,-1)])],8,us),s("input",{type:"number",class:"form-control form-control-sm text-center",value:e.cantidad,onChange:m=>g(e,m.target.value),min:"1",max:e.producto.stock_actual},null,40,bs),s("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:m=>g(e,e.cantidad+1),disabled:e.cantidad>=e.producto.stock},[...t[14]||(t[14]=[s("i",{class:"bi bi-plus"},null,-1)])],8,ms)])]),s("div",ps,[s("p",gs," $"+o(Number(e.subtotal).toFixed(2)),1),s("button",{class:"btn btn-danger btn-sm",onClick:m=>k(e.id)},[...t[15]||(t[15]=[s("i",{class:"bi bi-trash"},null,-1)])],8,fs)])])]))),128))])]),s("button",{class:"btn btn-outline-danger",onClick:w},[...t[16]||(t[16]=[s("i",{class:"bi bi-trash me-2"},null,-1),i("Vaciar Carrito ",-1)])])]),s("div",vs,[s("div",_s,[t[24]||(t[24]=s("div",{class:"p-4 border-b border-gray-200"},[s("h4",{class:"font-semibold text-lg"}," Resumen del Pedido ")],-1)),s("div",xs,[s("div",ys,[s("div",hs,[t[17]||(t[17]=s("span",null,"Productos:",-1)),s("span",null,o(c.detalles.length),1)]),s("div",ks,[t[18]||(t[18]=s("span",null,"Subtotal:",-1)),s("span",null," $"+o(Number(h()).toFixed(2)),1)]),_()>0?(a(),n("div",ws,[t[19]||(t[19]=s("span",null,"Descuentos:",-1)),s("span",null," -$"+o(Number(_()).toFixed(2)),1)])):u("",!0)]),t[23]||(t[23]=s("hr",null,null,-1)),s("div",Cs,[t[20]||(t[20]=s("h5",{class:"font-semibold"},"Total:",-1)),s("h5",$s," $"+o(Number(c.total).toFixed(2)),1)]),s("button",{onClick:C,class:"btn btn-primary w-100 mb-2",type:"button"},[...t[21]||(t[21]=[s("i",{class:"bi bi-credit-card me-2"},null,-1),i(" Realizar Pedido ",-1)])]),x(d(y),{href:l.route("dashboard"),class:"btn btn-outline-secondary w-100"},{default:p(()=>[...t[22]||(t[22]=[s("i",{class:"bi bi-arrow-left me-2"},null,-1),i("Continuar Comprando ",-1)])]),_:1},8,["href"])])])])]))])]),b.value?(a(),n("div",Ns,[s("div",Ss,[s("div",Fs,[s("div",Ps,[t[25]||(t[25]=s("h5",{class:"modal-title"},[s("i",{class:"bi bi-geo-alt me-2"}),i(" Dirección de Entrega ")],-1)),s("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=e=>b.value=!1)})]),s("form",{onSubmit:z($,["prevent"])},[s("div",js,[t[31]||(t[31]=s("div",{class:"alert alert-info"},[s("i",{class:"bi bi-info-circle me-2"}),s("small",null," Ingresa la dirección donde deseas recibir tu pedido. El pago se realizará mediante código QR. ")],-1)),s("div",zs,[t[26]||(t[26]=s("label",{for:"direccion",class:"form-label"},[i(" Dirección Completa "),s("span",{class:"text-danger"},"*")],-1)),D(s("textarea",{id:"direccion","onUpdate:modelValue":t[1]||(t[1]=e=>d(r).direccion_entrega=e),class:"form-control",rows:"4",placeholder:"Ej: Calle Los Pinos #123, Zona Sur, La Paz - Referencias: Frente al mercado",required:"",minlength:"10",maxlength:"500"},null,512),[[I,d(r).direccion_entrega]]),t[27]||(t[27]=s("small",{class:"text-muted"}," Mínimo 10 caracteres. Incluye referencias para facilitar la entrega. ",-1)),d(r).errors.direccion_entrega?(a(),n("div",Ds,o(d(r).errors.direccion_entrega),1)):u("",!0)]),s("div",Is,[s("h6",Ms,[t[28]||(t[28]=s("i",{class:"bi bi-cash-coin me-2"},null,-1)),t[29]||(t[29]=i(" Total a Pagar: ",-1)),s("strong",null,"Bs. "+o(Number(c.total).toFixed(2)),1)]),t[30]||(t[30]=s("small",null," Se generará un código QR para realizar el pago. ",-1))])]),s("div",Ts,[s("button",{type:"button",class:"btn btn-secondary",onClick:t[2]||(t[2]=e=>b.value=!1),disabled:d(r).processing}," Cancelar ",8,Vs),s("button",{type:"submit",class:"btn btn-primary",disabled:d(r).processing||!d(r).direccion_entrega},[d(r).processing?(a(),n("span",Bs,[...t[32]||(t[32]=[s("i",{class:"bi bi-hourglass-split me-2"},null,-1),i(" Procesando... ",-1)])])):(a(),n("span",Rs,[...t[33]||(t[33]=[s("i",{class:"bi bi-check-circle me-2"},null,-1),i(" Confirmar Pedido ",-1)])]))],8,Es)])],32)])])])):u("",!0)]),_:1}))}},Os=T(Ls,[["__scopeId","data-v-a05575d4"]]);export{Os as default};
