import{r as y,h as z,g as K,w as p,b as t,a as w,c as d,f as c,e as i,t as e,o as a,u as A,i as L,n as U,x as Q,F as x,m as C,j as W,y as X}from"./app-BM_Csk7S.js";import{_ as Y}from"./AppLayout-Aol2IiYi.js";import{_ as Z}from"./PagoModal-BNGzChgL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DialogModal-KP0K2W7x.js";import"./Modal-DVp3ZsaT.js";import"./PrimaryButton-DmRnZn5i.js";import"./SecondaryButton-CbdVSPUO.js";const tt={class:"container py-4"},st={class:"row mb-4"},et={class:"col-lg-12"},ot={class:"d-flex justify-content-between align-items-center"},nt={class:"mb-0"},lt={key:0,class:"alert alert-success alert-dismissible fade show mb-4",role:"alert"},at={key:1,class:"alert alert-danger alert-dismissible fade show mb-4",role:"alert"},dt={class:"card mb-4"},it={class:"card-body"},rt={class:"row"},ct={class:"col-md-6"},ut={class:"col-md-6"},mt={key:0},bt={class:"badge bg-danger"},gt={class:"row"},vt={class:"col-md-3"},ht={class:"text-primary"},ft={class:"col-md-3"},yt={class:"col-md-3"},pt={class:"text-success"},wt={class:"col-md-3"},xt={class:"text-danger"},Ct={class:"mt-3"},Pt={class:"progress",style:{height:"30px"}},kt={class:"card mb-4"},Mt={class:"card-header bg-warning text-dark d-flex justify-content-between align-items-center"},_t={class:"card-body"},Ft={class:"table-responsive"},Bt={class:"table table-hover"},Vt={class:"text-end"},$t={class:"text-end text-success"},Dt={class:"text-end text-danger"},Et={class:"text-center"},St={key:0,class:"badge bg-danger"},Nt={key:1,class:"text-muted"},jt={class:"text-center"},It={class:"text-center"},Ot=["onClick"],Tt=["onClick"],zt={colspan:"8",class:"bg-light"},At={class:"p-3"},Lt={class:"fw-bold mb-3"},Ut={class:"table table-sm"},Ht={class:"d-flex gap-3"},Yt={__name:"Show",props:{credito:Object,metodosPago:Array},setup(n){const m=n,v=y(!1),h=y(null),f=y(null),r=l=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB",minimumFractionDigits:2}).format(l),b=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),H=l=>({pendiente:"badge bg-warning",pagado:"badge bg-success",vencido:"badge bg-danger"})[l]||"badge bg-secondary",R=l=>({pendiente:"badge bg-warning",pagado:"badge bg-success",vencido:"badge bg-danger"})[l]||"badge bg-secondary",P=z(()=>m.credito.monto_credito===0?0:m.credito.monto_pagado/m.credito.monto_credito*100),q=z(()=>{var l;return(l=m.credito.cuotas)==null?void 0:l.some(s=>s.estado==="pendiente"||s.estado==="vencido")}),k=(l=null)=>{f.value=l,v.value=!0},G=()=>{v.value=!1,f.value=null},J=l=>{h.value=h.value===l?null:l};return(l,s)=>(a(),K(Y,{title:"Detalle del Crédito"},{default:p(()=>{var M,_,F,B,V,$,D,E,S,N,j,I;return[t("div",tt,[t("div",st,[t("div",et,[t("div",ot,[t("div",null,[t("h2",nt,[s[1]||(s[1]=t("i",{class:"bi bi-credit-card me-2"},null,-1)),i(" Detalle del Crédito #"+e(n.credito.id),1)])])])])]),(M=l.$page.props.flash)!=null&&M.success?(a(),d("div",lt,[s[2]||(s[2]=t("i",{class:"bi bi-check-circle me-2"},null,-1)),i(" "+e(l.$page.props.flash.success)+" ",1),s[3]||(s[3]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):c("",!0),(_=l.$page.props.errors)!=null&&_.error?(a(),d("div",at,[s[4]||(s[4]=t("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),i(" "+e(l.$page.props.errors.error)+" ",1),s[5]||(s[5]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert"},null,-1))])):c("",!0),t("div",dt,[s[22]||(s[22]=t("div",{class:"card-header bg-primary text-white"},[t("h5",{class:"mb-0"},"Información del Crédito")],-1)),t("div",it,[t("div",rt,[t("div",ct,[s[10]||(s[10]=t("h6",{class:"fw-bold mb-3"},"Cliente",-1)),t("p",null,[s[6]||(s[6]=t("strong",null,"Nombre:",-1)),i(" "+e((B=(F=n.credito.venta)==null?void 0:F.user)==null?void 0:B.nombre)+" "+e(($=(V=n.credito.venta)==null?void 0:V.user)==null?void 0:$.apellidos),1)]),t("p",null,[s[7]||(s[7]=t("strong",null,"CI:",-1)),i(" "+e((E=(D=n.credito.venta)==null?void 0:D.user)==null?void 0:E.ci),1)]),t("p",null,[s[8]||(s[8]=t("strong",null,"Teléfono:",-1)),i(" "+e((N=(S=n.credito.venta)==null?void 0:S.user)==null?void 0:N.telefono),1)]),t("p",null,[s[9]||(s[9]=t("strong",null,"Email:",-1)),i(" "+e((I=(j=n.credito.venta)==null?void 0:j.user)==null?void 0:I.email),1)])]),t("div",ut,[s[16]||(s[16]=t("h6",{class:"fw-bold mb-3"}," Información del Crédito ",-1)),t("p",null,[s[11]||(s[11]=t("strong",null,"Venta:",-1)),w(A(L),{href:l.route("ventas.show",n.credito.venta_id),class:"text-primary"},{default:p(()=>{var o;return[i(e((o=n.credito.venta)==null?void 0:o.numero_venta),1)]}),_:1},8,["href"])]),t("p",null,[s[12]||(s[12]=t("strong",null,"Fecha Otorgamiento:",-1)),i(" "+e(b(n.credito.fecha_otorgamiento)),1)]),t("p",null,[s[13]||(s[13]=t("strong",null,"Fecha Vencimiento:",-1)),i(" "+e(b(n.credito.fecha_vencimiento)),1)]),t("p",null,[s[14]||(s[14]=t("strong",null,"Estado:",-1)),t("span",{class:U(H(n.credito.estado))},e(n.credito.estado.toUpperCase()),3)]),n.credito.dias_mora>0?(a(),d("p",mt,[s[15]||(s[15]=t("strong",{class:"text-danger"},"Días de Mora:",-1)),t("span",bt,e(n.credito.dias_mora)+" días",1)])):c("",!0)])]),s[21]||(s[21]=t("hr",null,null,-1)),t("div",gt,[t("div",vt,[s[17]||(s[17]=t("h6",{class:"fw-bold"},"Monto Total",-1)),t("h4",ht,e(r(n.credito.monto_credito)),1)]),t("div",ft,[s[18]||(s[18]=t("h6",{class:"fw-bold"},"Total Cuotas",-1)),t("h4",null,e(n.credito.cuotas_total)+" cuotas",1)]),t("div",yt,[s[19]||(s[19]=t("h6",{class:"fw-bold"},"Monto Pagado",-1)),t("h4",pt,e(r(n.credito.monto_pagado)),1)]),t("div",wt,[s[20]||(s[20]=t("h6",{class:"fw-bold"},"Monto Pendiente",-1)),t("h4",xt,e(r(n.credito.monto_pendiente)),1)])]),t("div",Ct,[t("div",Pt,[t("div",{class:"progress-bar bg-success",style:Q({width:P.value+"%"})},e(P.value.toFixed(1))+"% Pagado ",5)])])])]),t("div",kt,[t("div",Mt,[s[24]||(s[24]=t("h5",{class:"mb-0"},"Plan de Cuotas",-1)),q.value?(a(),d("button",{key:0,onClick:s[0]||(s[0]=o=>k()),class:"btn btn-sm btn-success"},[...s[23]||(s[23]=[t("i",{class:"bi bi-cash-coin me-2"},null,-1),i(" Registrar Pago ",-1)])])):c("",!0)]),t("div",_t,[t("div",Ft,[t("table",Bt,[s[28]||(s[28]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"#"),t("th",{class:"text-end"},"Monto"),t("th",null,"Fecha Vencimiento"),t("th",{class:"text-end"},"Monto Pagado"),t("th",{class:"text-end"}," Monto Pendiente "),t("th",{class:"text-center"},"Mora"),t("th",{class:"text-center"},"Estado"),t("th",{class:"text-center"},"Acciones")])],-1)),t("tbody",null,[(a(!0),d(x,null,C(n.credito.cuotas,o=>(a(),d("tr",{key:o.id},[t("td",null,"Cuota "+e(o.numero_cuota),1),t("td",Vt,e(r(o.monto)),1),t("td",null,e(b(o.fecha_vencimiento)),1),t("td",$t,e(r(o.monto_pagado)),1),t("td",Dt,e(r(o.monto_pendiente)),1),t("td",Et,[o.dias_mora>0?(a(),d("span",St,e(o.dias_mora)+" días ",1)):(a(),d("span",Nt,"-"))]),t("td",jt,[t("span",{class:U(R(o.estado))},e(o.estado.toUpperCase()),3)]),t("td",It,[o.estado!=="pagado"?(a(),d("button",{key:0,onClick:g=>k(o.id),class:"btn btn-sm btn-success",title:"Pagar cuota"},[...s[25]||(s[25]=[t("i",{class:"bi bi-cash-coin"},null,-1),i(" Pagar ",-1)])],8,Ot)):c("",!0),o.pagos&&o.pagos.length>0?(a(),d("button",{key:1,onClick:g=>J(o.id),class:"btn btn-sm btn-info ms-1",title:"Ver pagos"},[...s[26]||(s[26]=[t("i",{class:"bi bi-eye"},null,-1)])],8,Tt)):c("",!0)])]))),128)),(a(!0),d(x,null,C(n.credito.cuotas,o=>{var g;return W((a(),d("tr",{key:"pagos-"+o.id},[t("td",zt,[t("div",At,[t("h6",Lt," Historial de Pagos - Cuota #"+e(o.numero_cuota),1),t("table",Ut,[s[27]||(s[27]=t("thead",null,[t("tr",null,[t("th",null,"Fecha"),t("th",null,"Monto"),t("th",null,"Método")])],-1)),t("tbody",null,[(a(!0),d(x,null,C(o.pagos,u=>{var O,T;return a(),d("tr",{key:u.id},[t("td",null,e(b(u.fecha)),1),t("td",null,e(r(u.monto)),1),t("td",null,e(((O=u.metodoPago)==null?void 0:O.nombre)||((T=u.metodo_pago)==null?void 0:T.nombre)),1)])}),128))])])])])])),[[X,h.value===o.id&&((g=o.pagos)==null?void 0:g.length)>0]])}),128))])])])])]),t("div",Ht,[w(A(L),{href:l.route("creditos.index"),class:"btn btn-secondary"},{default:p(()=>[...s[29]||(s[29]=[t("i",{class:"bi bi-arrow-left me-2"},null,-1),i(" Volver a Créditos ",-1)])]),_:1},8,["href"])])]),w(Z,{show:v.value,cuotas:n.credito.cuotas,metodosPago:n.metodosPago,cuotaPreseleccionada:f.value,onClose:G},null,8,["show","cuotas","metodosPago","cuotaPreseleccionada"])]}),_:1}))}};export{Yt as default};
