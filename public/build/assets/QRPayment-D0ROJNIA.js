import{r as f,h as m,c as d,b as t,e as i,f as g,t as o,n as p,K as S,o as u}from"./app-DTocK5dB.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"qr-payment-container"},B={class:"card shadow-sm"},q={class:"card-body text-center p-4"},E={class:"qr-image-container mb-3"},C=["src"],I={class:"payment-info mb-3"},R={class:"alert alert-info"},V={class:"mb-2"},D={class:"mb-0 small text-muted"},Q={class:"transaction-info text-muted small"},F={class:"mb-1"},N={class:"text-dark"},T={key:0,class:"mb-0"},z={class:"mt-3"},K={key:0,class:"mt-3"},L=["disabled"],M={key:1,class:"mt-3"},j=["disabled"],A={__name:"QRPayment",props:{qrImage:{type:String,required:!0},transactionId:{type:String,required:!0},monto:{type:[Number,String],required:!0},descripcion:{type:String,default:""},status:{type:String,default:"pending"},expiration:{type:String,default:null},showRefreshButton:{type:Boolean,default:!0},showSimulateButton:{type:Boolean,default:!0},onStatusChange:{type:Function,default:null}},setup(s){const r=s,n=f(!1),l=f(!1),b=m(()=>({pending:"bg-warning text-dark",completed:"bg-success",failed:"bg-danger"})[r.status]||"bg-secondary"),h=m(()=>({pending:"bi-hourglass-split",completed:"bi-check-circle-fill",failed:"bi-x-circle-fill"})[r.status]||"bi-question-circle"),y=m(()=>({pending:"Pendiente de Pago",completed:"Pago Confirmado",failed:"Pago Fallido"})[r.status]||"Desconocido"),x=a=>parseFloat(a||0).toFixed(2),v=a=>a?new Date(a).toLocaleString("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",w=async()=>{n.value=!0;try{window.location.reload()}catch(a){console.error("Error al verificar estado:",a)}finally{n.value=!1}},_=async()=>{var a,e;if(confirm("¿Simular pago completado? (Solo para desarrollo)")){l.value=!0;try{(await S.post("/pagofacil-simulado/confirmar-pago",{transaction_id:r.transactionId})).data.success&&(alert("Pago simulado exitosamente. Recargando página..."),window.location.reload())}catch(c){console.error("Error al simular pago:",c),alert("Error al simular pago: "+(((e=(a=c.response)==null?void 0:a.data)==null?void 0:e.error)||c.message))}finally{l.value=!1}}};return(a,e)=>(u(),d("div",P,[t("div",B,[e[4]||(e[4]=t("div",{class:"card-header bg-primary text-white text-center"},[t("h5",{class:"mb-0"},[t("i",{class:"bi bi-qr-code me-2"}),i(" Escanea para Pagar ")])],-1)),t("div",q,[t("div",E,[t("img",{src:s.qrImage,alt:"Código QR para pago",class:"qr-image",style:{"max-width":"280px",width:"100%",height:"auto",border:"3px solid #f0f0f0","border-radius":"8px",padding:"10px"}},null,8,C)]),t("div",I,[t("div",R,[t("h4",V,[t("strong",null,"Bs. "+o(x(s.monto)),1)]),t("p",D,o(s.descripcion||"Escanea el código QR con tu app bancaria para completar el pago"),1)])]),t("div",Q,[t("p",F,[e[0]||(e[0]=t("strong",null,"ID de Transacción:",-1)),e[1]||(e[1]=t("br",null,null,-1)),t("code",N,o(s.transactionId),1)]),s.expiration?(u(),d("p",T,[e[2]||(e[2]=t("i",{class:"bi bi-clock me-1"},null,-1)),i(" Expira: "+o(v(s.expiration)),1)])):g("",!0)]),t("div",z,[t("span",{class:p(["badge",b.value])},[t("i",{class:p(["bi",h.value])},null,2),i(" "+o(y.value),1)],2)]),s.status==="pending"&&s.showRefreshButton?(u(),d("div",K,[t("button",{onClick:w,class:"btn btn-outline-primary btn-sm",disabled:n.value},[t("i",{class:p(["bi bi-arrow-clockwise me-1",{spin:n.value}])},null,2),i(" "+o(n.value?"Verificando...":"Verificar Pago"),1)],8,L)])):g("",!0),s.showSimulateButton&&s.status==="pending"?(u(),d("div",M,[t("button",{onClick:_,class:"btn btn-warning btn-sm",disabled:l.value},[e[3]||(e[3]=t("i",{class:"bi bi-lightning-fill me-1"},null,-1)),i(" "+o(l.value?"Simulando...":"Simular Pago (DEV)"),1)],8,j)])):g("",!0)])])]))}},J=k(A,[["__scopeId","data-v-5ff362ac"]]);export{J as Q};
